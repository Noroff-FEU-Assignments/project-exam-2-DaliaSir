{"ast":null,"code":"import _objectSpread from\"G:/FRONT-END/2nd YEAR/Semester2/4 Project Exam2/project-exam-2-daliasir/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"G:/FRONT-END/2nd YEAR/Semester2/4 Project Exam2/project-exam-2-daliasir/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"G:/FRONT-END/2nd YEAR/Semester2/4 Project Exam2/project-exam-2-daliasir/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"G:\\\\FRONT-END\\\\2nd YEAR\\\\Semester2\\\\4 Project Exam2\\\\project-exam-2-daliasir\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useState,useContext}from\"react\";import{useNavigate}from\"react-router-dom\";import{useForm}from\"react-hook-form\";import*as yup from\"yup\";import{yupResolver}from\"@hookform/resolvers/yup\";import axios from\"axios\";import FormError from\"../common/FormError\";import{BASE_URL,TOKEN_PATH}from\"../../constants/api\";import AuthContext from\"../../context/AuthContext\";import Form from\"react-bootstrap/Form\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var url=BASE_URL+TOKEN_PATH;var validationSchema=yup.object().shape({username:yup.string().required(\"Please enter your username\"),password:yup.string().required(\"Please enter your password\")});export default function SigninForm(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),submitting=_useState2[0],setSubmitting=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),signinError=_useState4[0],setSigninError=_useState4[1];var navigate=useNavigate();var _useForm=useForm({resolver:yupResolver(validationSchema)}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.formState.errors;var _useContext=useContext(AuthContext),_useContext2=_slicedToArray(_useContext,2),setAuth=_useContext2[1];function onSubmit(_x){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setSubmitting(true);setSigninError(null);console.log(data);_context.prev=3;_context.next=6;return axios.post(url,data);case 6:response=_context.sent;console.log(\"response\",response.data);setAuth(response.data);navigate(\"/\");_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](3);console.log(\"error\",_context.t0);setSigninError(\"Username or password is incorrect. Please try again.\");case 16:_context.prev=16;setSubmitting(false);return _context.finish(16);case 19:case\"end\":return _context.stop();}}},_callee,null,[[3,12,16,19]]);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit(onSubmit),className:\"signin-form\",children:[signinError&&/*#__PURE__*/_jsx(FormError,{children:signinError}),/*#__PURE__*/_jsxs(\"fieldset\",{disabled:submitting,children:[/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},register(\"username\")),{},{className:\"form-control\",placeholder:\"Your username\"})),errors.username&&/*#__PURE__*/_jsx(FormError,{children:errors.username.message})]}),/*#__PURE__*/_jsxs(Form.Group,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},register(\"password\")),{},{className:\"form-control\",placeholder:\"Your password\",type:\"password\"})),errors.password&&/*#__PURE__*/_jsx(FormError,{children:errors.password.message})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:submitting?\"Signing in...\":\"Sign in\"})]})]});}","map":{"version":3,"sources":["G:/FRONT-END/2nd YEAR/Semester2/4 Project Exam2/project-exam-2-daliasir/src/components/signin/SigninForm.js"],"names":["useState","useContext","useNavigate","useForm","yup","yupResolver","axios","FormError","BASE_URL","TOKEN_PATH","AuthContext","Form","url","validationSchema","object","shape","username","string","required","password","SigninForm","submitting","setSubmitting","signinError","setSigninError","navigate","resolver","register","handleSubmit","errors","formState","setAuth","onSubmit","data","console","log","post","response","message"],"mappings":"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","sourcesContent":["import { useState, useContext } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport * as yup from \"yup\";\r\nimport { yupResolver } from \"@hookform/resolvers/yup\";\r\nimport axios from \"axios\";\r\nimport FormError from \"../common/FormError\";\r\nimport { BASE_URL, TOKEN_PATH } from \"../../constants/api\";\r\nimport AuthContext from \"../../context/AuthContext\";\r\nimport Form from \"react-bootstrap/Form\";\r\n\r\nconst url = BASE_URL + TOKEN_PATH;\r\n\r\nconst validationSchema = yup.object().shape({\r\n  username: yup.string().required(\"Please enter your username\"),\r\n  password: yup.string().required(\"Please enter your password\"),\r\n});\r\n\r\nexport default function SigninForm() {\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [signinError, setSigninError] = useState(null);\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const { register, handleSubmit, formState: { errors } } = useForm({\r\n    resolver: yupResolver(validationSchema),\r\n  });\r\n\r\n\r\n  const [, setAuth] = useContext(AuthContext);\r\n\r\n  async function onSubmit(data) {\r\n    setSubmitting(true);\r\n    setSigninError(null);\r\n\r\n    console.log(data);\r\n\r\n    try {\r\n      const response = await axios.post(url, data);\r\n      console.log(\"response\", response.data);\r\n      setAuth(response.data);\r\n      navigate(\"/\");\r\n    } catch (error) {\r\n      console.log(\"error\", error);\r\n      setSigninError(\"Username or password is incorrect. Please try again.\");\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Form onSubmit={handleSubmit(onSubmit)} className=\"signin-form\">\r\n      {signinError && <FormError>{signinError}</FormError>}\r\n      <fieldset disabled={submitting}>\r\n        <Form.Group className=\"mb-3\" >\r\n          <Form.Label>Username</Form.Label>\r\n          <input {...register(\"username\")} className=\"form-control\" placeholder=\"Your username\" />\r\n          {errors.username && <FormError>{errors.username.message}</FormError>}\r\n        </Form.Group>\r\n        <Form.Group className=\"mb-3\" >\r\n          <Form.Label>Password</Form.Label>\r\n          <input {...register(\"password\")} className=\"form-control\" placeholder=\"Your password\" type=\"password\" />\r\n          {errors.password && <FormError>{errors.password.message}</FormError>}\r\n        </Form.Group>\r\n        <button type=\"submit\" className=\"btn btn-primary\" >{submitting ? \"Signing in...\" : \"Sign in\"}</button>\r\n      </fieldset>\r\n    </Form>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}